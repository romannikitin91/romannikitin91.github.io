<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Pizza Market</title>
    <link rel="stylesheet" href="css/icons.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <section class="product-page">
        <div class="overlay">
            <div class="pop-up">
                <a href='#' class="pop-up__close">&#10006;</a>
                <div class="pop-up-content">
                </div>
            </div>
        </div>
        <header>
            <a href="/" class="header__logo">Pizza Market</a>
            <h2 class="header__title">Меню</h2>
        </header>
        <main>
            <div class="container">
                <h1 class="products-page__title">
                    Пицца
                </h1>
                <div class="navigation">
                    <div class="navigation-appearance">
                        <a href="#" class="tile icon-tile" title='отображение в виде сетки'></a>
                        <a href="#" class="list icon-list" title = 'отображение в виде списка'></a>
                    </div>
                    <div class="sort-wrapper">
                        <div>
                            <span>Название</span>
                            <select class='names-select'>
                                <option value="none">----</option>
                                <option value="namesToLow">В алфавитном порядке</option>
                                <option value="namesToHigh">В обратном алфавитном порядке</option>
                            </select>
                        </div>
                        <div>
                            <span>Цена</span>
                            <select class='price-select'>
                                <option value="none">----</option>
                                <option value="priceToLow">От большей к меньшей</option>
                                <option value="priceToHigh">От меньшей к большей</option>
                            </select>
                        </div>                        
                    </div>
                </div> 
                <div class="products-wrapper">
                    <div class="products-filter">
                        <h4 class="products-filter__ingredients">
                            Ингредиенты
                        </h4>
                        <ul class="products-filter__ingredients-list">
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="huntingSausages" id='huntingSausages' class='products-filter__checkbox'><label>колбаски охотничьи</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="tomatoSauce" id='tomatoSauce' class='products-filter__checkbox'><label>соус томатный</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="crimeanOnion" id='crimeanOnion' class='products-filter__checkbox'><label>лук крымский</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="olives" id='olives' class='products-filter__checkbox'><label>оливки</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="mozzarella" id='mozzarella' class='products-filter__checkbox'><label>сыр моцарелла</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="oregano" id='oregano' class='products-filter__checkbox'><label>орегано</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="parsley" id='parsley' class='products-filter__checkbox'><label>петрушка</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="pickledMushrooms" id='pickledMushrooms' class='products-filter__checkbox'><label>опята маринованные</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="creamSauce" id='creamSauce' class='products-filter__checkbox'><label>соус сливочный</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="champignon" id='champignon' class='products-filter__checkbox'><label>шампиньоны</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="chickenLeg" id='chickenLeg' class='products-filter__checkbox'><label>куриный окорок</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="pork" id='pork' class='products-filter__checkbox'><label>свинина</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="cherryTomato" id='cherryTomato' class='products-filter__checkbox'><label>помидоры черри</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="parmesanCheese" id='parmesanCheese' class='products-filter__checkbox'><label>сыр пармезан</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="basil" id='basil' class='products-filter__checkbox'><label>базилик</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="bacon" id='bacon' class='products-filter__checkbox'><label>бекон</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="sweetChiliSauce" id='sweetChiliSauce' class='products-filter__checkbox'><label>соус свит чили</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="pineapples" id='pineapples' class='products-filter__checkbox'><label>ананасы</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="bulgarianPepper" id='bulgarianPepper' class='products-filter__checkbox'><label>перец болгарский</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="ham" id='ham' class='products-filter__checkbox'><label>ветчина</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="balyk" id='balyk' class='products-filter__checkbox'><label>балык</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="pepperoni" id='pepperoni' class='products-filter__checkbox'><label>пепперони</label></li><br />
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="tomato" id='tomato' class='products-filter__checkbox'><label>помидор</label></li>
                            <li class='products-filter__ingredients-item'><input type="checkbox" name="garlic" id='garlic' class='products-filter__checkbox'><label>чеснок</label></li>
                        </ul>
                        
                    </div>
                    <div class="products-list">

                    </div>  
                </div>             

            </div>            
        </main>

    </section>
    <script>
        let huntingSausages = {name: "колбаски охотничьи", price: 28, calories: 120, amount: 1};
        let tomatoSauce = {name: "соус томатный", price: 5, calories: 8, amount: 1};
        let crimeanOnion = {name: "лук крымский", price: 6, calories: 10, amount: 1};
        let olives = {name: "оливки", price: 8, calories: 5, amount: 1};
        let mozzarella = {name: "сыр моцарелла", price: 15, calories: 30, amount: 1};
        let oregano = {name: "орегано", price: 17, calories: 7, amount: 1};
        let parsley = {name: "петрушка", price: 4, calories: 3, amount: 1};
        let pickledMushrooms = {name: "опята маринованные", price: 20, calories: 28, amount: 1};
        let creamSauce = {name: "соус сливочный", price: 6, calories: 6, amount: 1};
        let champignon = {name: "шампиньоны", price: 23, calories: 21, amount: 1};
        let chickenLeg = {name: "куриный окорок", price: 20, calories: 100, amount: 1};
        let pork = {name: "свинина", price: 27, calories: 115, amount: 1};
        let cherryTomato = {name: "помидоры черри", price: 16, calories: 14, amount: 1};
        let parmesanCheese = {name: "сыр пармезан", price: 18, calories: 25, amount: 1};
        let basil = {name: "базилик", price: 7, calories: 5, amount: 1};
        let bacon = {name: "бекон", price: 29, calories: 125, amount: 1};
        let sweetChiliSauce = {name: "соус свит чили", price: 8, calories: 6, amount: 1};
        let pineapples = {name: "ананасы", price: 21, calories: 15, amount: 1};
        let bulgarianPepper = {name: "перец болгарский", price: 9, calories: 12, amount: 1};
        let tomato = {name: "помидор", price: 14, calories: 11, amount: 1};
        let garlic = {name: "чеснок", price: 3, calories: 7, amount: 1};
        let ham = {name: "ветчина", price: 24, calories: 123, amount: 1};
        let balyk = {name: "балык", price: 29, calories: 126, amount: 1};
        let pepperoni = {name: "пепперони", price: 28, calories: 115, amount: 1};
        let arr = [{name: "Баварская", ingredients: {huntingSausages, tomatoSauce, crimeanOnion, olives, mozzarella, oregano, parsley, pickledMushrooms},
                    image: "../img/bavarskaya.jpg"}, 
                  {name: "Мясная", ingredients: {creamSauce, champignon, chickenLeg, pork,crimeanOnion, cherryTomato, mozzarella, parmesanCheese, oregano, basil},
                   image: "../img/meat.png"}, 
                  {name: "Карбонара",  ingredients: {creamSauce, bacon, crimeanOnion, cherryTomato, mozzarella, parmesanCheese, oregano, basil},
                   image: "../img/carbonara.jpg"}, 
                  {name: "Свит чили со свининой", ingredients: {sweetChiliSauce, pork, pineapples, bulgarianPepper,mozzarella, parmesanCheese, oregano, basil },
                   image: "../img/svitpork.jpg"}, 
                  {name: "Чесночная с беконом", ingredients: {tomatoSauce, mozzarella,tomato, bacon, garlic,
                  parmesanCheese, oregano, parsley }, image: "../img/garlicbacon.jpg"}, 
                  {name: "Свит чили с курицей", ingredients: {sweetChiliSauce, chickenLeg, pineapples, bulgarianPepper,
                  mozzarella, parmesanCheese, oregano, basil }, image: "../img/svitchicken.jpg"}, 
                  {name: "Маринара", ingredients: {tomatoSauce, mozzarella,tomato, chickenLeg,
                  parmesanCheese, oregano, parsley }, image: "../img/marinara.jpg"},
                  {name: "Квинта филона", ingredients: {tomatoSauce, mozzarella,tomato, bacon, chickenLeg,
                  olives, parmesanCheese, oregano, parsley}, image: "../img/kvintafilona.jpg"},  
                  {name: "С ананасами и ветчиной", ingredients: {tomatoSauce, mozzarella, ham, 
                  olives, pineapples,  parmesanCheese, oregano }, image: "../img/pinappleham.jpg"}, 
                  {name: "Итальяни", ingredients: {tomatoSauce,tomato, chickenLeg, mozzarella, ham, bacon, champignon, bulgarianPepper,  parmesanCheese, oregano,
                    parsley }, image: "../img/italiani.jpg"}, 
                  {name: "Маргарита", ingredients: {tomatoSauce, mozzarella, tomato, oregano}, image: "../img/margarita.jpg"}, 
                  {name: "Капричоза", ingredients: {tomatoSauce, mozzarella,tomato, ham,
                  parmesanCheese, oregano, parsley }, image: "../img/caprichosa.jpg"},  
                  {name: "С балыком и беконом", ingredients: {tomatoSauce, mozzarella,tomato,bacon, 
                  balyk, parmesanCheese, oregano, parsley }, image: "../img/balykbacon.jpg"},
                  {name: "Реджина", ingredients: {creamSauce, champignon, chickenLeg,
                  crimeanOnion, mozzarella, parmesanCheese, oregano }, image: "../img/regina.jpg"},
                  {name: "Кальцоне с ветчиной", ingredients: {tomatoSauce, mozzarella,tomato, ham,
                  crimeanOnion, oregano, parsley }, image: "../img/calcioneham.jpg"}, 
                  {name: "Неаполитана", ingredients: {huntingSausages, tomatoSauce, parmesanCheese, 
                  tomato,  olives, mozzarella, oregano, parsley }, image: "../img/napoli.jpg"}, 
                  {name: "С курицей и ананасами", ingredients: {tomatoSauce, mozzarella, oregano,
                  chickenLeg, pineapples}, image: "../img/chickenpinapple.jpg"},
                  {name: "Пепперони", ingredients: {tomatoSauce, mozzarella, oregano,
                  pepperoni, pineapples}, image: "../img/pepperoni.jpg"}];
        
        let allIngredientes = {};
        function createAllIngredients(allIngredientes){
            for(let i = 0; i < arr.length; i++){
                for(let ingredient in arr[i].ingredients){
                    allIngredientes[ingredient] = arr[i].ingredients[ingredient];
                }
            }
        }
        createAllIngredients(allIngredientes);
        let productsView = 'tile';

        let tile = document.querySelector('.tile');
        let list = document.querySelector('.list');
    
        tile.addEventListener('click', function(){
            if(productsView != 'tile'){
                productsView = 'tile';
                clearProducts();
                if(filteredArr.length !== 0){
                    renderProducts(filteredArr, productsView);
                } else{
                    renderProducts(arr, productsView);      
                }
            } else{
            }
        })
        list.addEventListener('click', function(){
            if(productsView != 'list'){
                productsView = 'list';
                clearProducts();
                if(filteredArr.length !== 0){
                    renderProducts(filteredArr, productsView);
                } else{
                    renderProducts(arr, productsView);      
                }
            }
        })
        function sortNamesToLow(arr){
            arr.sort((a, b) => a.name.replace(/ /g, "") > b.name.replace(/ /g, "") ? 1 : -1);
        }
        function sortNamesToHigh(arr){
            arr.sort((a, b) => a.name.replace(/ /g, "") < b.name.replace(/ /g, "") ? 1 : -1);
        }
        function sortPricesToHigh(arr){
            arr.sort((a, b) => a.price - b.price);
        }

        function sortPricesToLow(arr){
            arr.sort((a, b) => b.price - a.price);
        }
        let filteredArr = [];
        function filterIngredients(checkedIngredientes, arr){
            filteredArr = [];
            for(let i = 0; i < arr.length; i++){
                if(checkIncludesIngredients(checkedIngredientes, arr[i].ingredients)){
                    filteredArr.push(arr[i]);
                }
            }
        };
        function checkIncludesIngredients(checkedIngredientes, pizzaObj){
            let counter = 0;
            for(let i = 0; i < checkedIngredientes.length; i++){
                if(checkedIngredientes[i] in pizzaObj){
                    counter++;
                }
            }
            if(counter === checkedIngredientes.length){
                return true;
            } else {
                return false;
            }
        };

        function clearProducts(){
            let productsCont = document.querySelector('.products-list');
            productsCont.innerHTML = '';
        }
        let productsList = document.querySelector('.products-list');
        function renderProducts(arr, productsView){
            let newHtml;
            if(productsView === 'tile'){
                for(let i = 0; i < arr.length; i++){
                    var productCard = document.createElement("div");
                    productCard.classList.add('product-card');
                    var cardSideFront = document.createElement("div");
                    cardSideFront.classList.add('card-side', 'product-card__front');
                    var cardSideBack = document.createElement("div");
                    cardSideBack.classList.add("card-side", "product-card__back");
                    var productCardName = document.createElement('h4');
                    productCardName.classList.add('product-card__name');
                    productCardName.innerText = arr[i].name;
                    var productCardIngredients = document.createElement('div');
                    productCardIngredients.classList.add('product-card__ingredients');
                    var productCardIngredientsTitle = document.createElement('span');
                    productCardIngredientsTitle.classList.add('product-card__ingredients-title');
                    productCardIngredientsTitle.innerText = "Состав: ";
                    var ingredientsList = document.createElement('ul');
                    for(var key in arr[i].ingredients){
                        var ingredient = document.createElement('li');
                        if(Object.keys(arr[i].ingredients)[Object.keys(arr[i].ingredients).length - 1] === key){
                            ingredient.innerText = arr[i].ingredients[key].name;
                        } else if(Object.keys(arr[i].ingredients)[Object.keys(arr[i].ingredients).length - 1] !== key){
                            ingredient.innerText = arr[i].ingredients[key].name+ ", ";
                        }
                        ingredientsList.appendChild(ingredient);
                    }
                    var changeIngredientes = document.createElement('a');
                    changeIngredientes.href = '#';
                    changeIngredientes.classList.add('prouct-card__add-ingredients');
                    changeIngredientes.innerText = 'Изменить состав пиццы';
                    var productCardCalorie = document.createElement('div');
                    productCardCalorie.classList.add('product-card__calorie');
                    var productCardCalorieTitle = document.createElement('span');
                    productCardCalorieTitle.classList.add("product-card__calorie-title");
                    productCardCalorieTitle.innerText = "Калорийность: ";
                    var caloriesSum = 10;
                    for (var key in arr[i].ingredients){
                        var productCardCaloresSum = document.createElement('span');
                        caloriesSum += arr[i].ingredients[key].calories*arr[i].ingredients[key].amount;
                    }
                    arr[i].calories = caloriesSum;
                    productCardCaloresSum.innerText = caloriesSum + " Ккал.";
                    var productCardPrice = document.createElement('h5');
                    productCardPrice.classList.add('product-card-price-tile');
                    var productCardPriceTitle = document.createElement('span');
                    productCardPriceTitle.classList.add('product-card__price-title');
                    productCardPriceTitle.innerText = "Цена: ";
                    var priceSum = 60;
                    for (var key in arr[i].ingredients){
                        var productCardPriceValue = document.createElement('span');
                        priceSum += arr[i].ingredients[key].price*arr[i].ingredients[key].amount;
                    }       
                    arr[i].price = priceSum;             
                    productCardPriceValue.innerText = priceSum + " грн.";
                    var productCardImg = document.createElement('div');
                    productCardImg.classList.add('product-card__img');
                    productCardImg.setAttribute("style", "background-image: url(" + arr[i].image + ")");

                    productsList.append(productCard);
                    productCard.append(cardSideFront);
                    productCard.append(cardSideBack);
                    cardSideFront.append(productCardName);
                    cardSideFront.append(productCardIngredients);
                    cardSideFront.append(changeIngredientes);
                    cardSideFront.append(productCardCalorie);
                    cardSideFront.append(productCardPrice);
                    cardSideBack.append(productCardImg);
                    productCardIngredients.append(productCardIngredientsTitle);
                    productCardIngredients.append(ingredientsList);
                    productCardCalorie.append(productCardCalorieTitle);
                    productCardCalorie.append(productCardCaloresSum);
                    productCardPrice.append(productCardPriceTitle);
                    productCardPrice.append(productCardPriceValue);
                }               
             } else if (productsView === 'list'){
                for(let i = 0; i < arr.length; i++){
                    var productCard = document.createElement("div");
                    productCard.classList.add('product-card--list');
                    var productCardLogo = document.createElement('div');
                    productCardLogo.classList.add('product-card__logo');
                    var productCardInfo = document.createElement('div');
                    productCardInfo.classList.add('product-card__info');
                    var productCardName = document.createElement('h4');
                    productCardName.classList.add('product-card__name', 'product-card__name--list');
                    productCardName.innerText = arr[i].name;
                    var productCardPriceList = document.createElement('h5');
                    productCardPriceList.classList.add('product-card-price-list');
                    productCardPriceList.innerText = arr[i].price;

                    productsList.append(productCard);
                    productCard.append(productCardLogo);
                    productCard.append(productCardInfo);
                    productCardInfo.append(productCardName);
                    productCardInfo.append(productCardPriceList);
                }                 
            }
        }
        let namesSelect = document.querySelector('.names-select');
        let priceSelect = document.querySelector('.price-select');
        //сортировка по названию вывод
        namesSelect.addEventListener('change', function(){
            if(priceSelect.value !== 'none'){
                priceSelect.value = 'none';
            }
            if (this.value === 'namesToLow'){
                if(filteredArr.length !== 0){
                    sortNamesToLow(filteredArr);
                    clearProducts();
                    renderProducts(filteredArr, productsView);                    
                } else if (filteredArr.length === 0){
                    sortNamesToLow(arr);
                    clearProducts();
                    renderProducts(arr, productsView);
                }
            } else if (this.value === 'namesToHigh'){
                if(filteredArr.length !== 0){
                    sortNamesToHigh(filteredArr);
                    clearProducts();
                    renderProducts(filteredArr, productsView);                    
                } else if (filteredArr.length === 0){
                    sortNamesToHigh(arr);
                    clearProducts();
                    renderProducts(arr, productsView);
                }
            }
        });
        //сортировка по цене вывод
        priceSelect.addEventListener('change', function(){
            if(namesSelect.value !== 'none'){
                namesSelect.value = 'none';
            }
            if (this.value === 'priceToHigh'){
                if(filteredArr.length !== 0){
                    sortPricesToHigh(filteredArr);
                    clearProducts();
                    renderProducts(filteredArr, productsView);                    
                } else if (filteredArr.length === 0){
                    sortPricesToHigh(arr);
                    clearProducts();
                    renderProducts(arr, productsView);
                }

            } else if (this.value === 'priceToLow'){
                if(filteredArr.length !== 0){
                    sortPricesToLow(filteredArr);
                    clearProducts();
                    renderProducts(filteredArr, productsView);                    
                } else if (filteredArr.length === 0){
                    sortPricesToLow(arr);
                    clearProducts();
                    renderProducts(arr, productsView);
                }
            }
        });       

        //фильтр по ингредиентам
        let checkedIngredientes = [];
        let checkedIngredientesUl = document.querySelector('.products-filter__ingredients-list');
        let checkedIngredientesLi = document.querySelectorAll('.products-filter__ingredients-item');
        checkedIngredientesUl.addEventListener('click', function(e){
            if (e.target.classList == 'products-filter__checkbox'){
                for (let i = 0; i < checkedIngredientesLi.length; i++){
                    if(checkedIngredientesLi[i].querySelector('input').checked){
                        checkedIngredientes.push(checkedIngredientesLi[i].querySelector('input').name);
                    }
                }
                clearProducts();
                if(namesSelect.value === 'namesToLow'){
                    sortNamesToLow(arr);
                } else if (namesSelect.value === 'namesToHigh'){
                    sortNamesToHigh(arr);
                } else if(priceSelect.value === 'priceToLow'){
                    sortPricesToLow(arr);                   
                } else if (priceSelect.value === 'priceToHigh'){
                    sortPricesToHigh(arr);                     
                }
                filterIngredients(checkedIngredientes, arr);
                renderProducts(filteredArr, productsView);
                checkedIngredientes = [];
            } else {};
        });

        renderProducts(arr, productsView);
        function renderPopup(target){
                    //наполнение попапа
                    var titleModal = document.createElement('h5');
                    titleModal.classList.add('product-modal__title');
                    titleModal.innerText = target.parentElement.querySelector('.product-card__name').innerText;
                    var priceCaliriesModal = document.createElement('div');
                    priceCaliriesModal.classList.add('product-modal__price-calories');
                    var priceModal = document.createElement('div');
                    var priceModalText = document.createElement('span');
                    priceModalText.innerText = "Цена: ";
                    var priceModalValue = document.createElement('span');

                    var caloriesModal = document.createElement('div');
                    var caloriesModalText = document.createElement('span');
                    caloriesModalText.innerText = "Калории: ";
                    var caloriesModalValue = document.createElement('span');

                    var ingredientsModal = document.createElement('div');
                    ingredientsModal.classList.add('product-modal__ingredient-wrapper');
                    var compositionModal = document.createElement('span');
                    compositionModal.classList.add('product-modal__composition');
                    compositionModal.innerText = 'Состав: ';
                    var ingredientsModalNotChecked = document.createElement('div');
                    var addIngredients = document.createElement('h5');
                    addIngredients.classList.add('product-modal__add');
                    addIngredients.innerText = 'Добавить ингредиенты';
                    ingredientsModalNotChecked.classList.add('product-modal__ingredient-wrapper-bottom');
                    for(let i = 0; i< arr.length; i++){
                        if(target.parentElement.querySelector('.product-card__name').innerText === arr[i].name){
                            var priceSum = 60;
                            var caloriesSum = 10;
                            for (var key in arr[i].ingredients){
                                priceSum += arr[i].ingredients[key].price*arr[i].ingredients[key].amount;
                                caloriesSum += arr[i].ingredients[key].calories*arr[i].ingredients[key].amount;
                            }       
                            arr[i].price = priceSum;   
                            priceModalValue.innerText = arr[i].price + " грн.";
                            arr[i].calories = caloriesSum;
                            caloriesModalValue.innerText = arr[i].calories + " Ккал.";
                            for(let ingredient in arr[i].ingredients){
                                if(arr[i].ingredients[ingredient].amount == 1){
                                    let ingredientsModalItem = document.createElement('span');
                                    ingredientsModalItem.classList.add('product-modal__ingredient-item');
                                    ingredientsModalItem.innerText = arr[i].ingredients[ingredient].name + ", ";
                                    ingredientsModalItem.dataset.amount = 1;
                                    ingredientsModalItem.dataset.name = ingredient;
                                    ingredientsModal.append(ingredientsModalItem);
                                }
                            }
                            for (let ingredient in allIngredientes){
                                for(let defaultIngredient in arr[i].ingredients){
                                    if(arr[i].ingredients[defaultIngredient].name == allIngredientes[ingredient].name){
                                        delete allIngredientes[ingredient];
                                        break;
                                    }
                                }
                            }
                            for(let ingredient in allIngredientes){
                                let ingredientsModalItemNotChecked = document.createElement('span');
                                ingredientsModalItemNotChecked.classList.add('product-modal__ingredient-item');
                                ingredientsModalItemNotChecked.innerText = allIngredientes[ingredient].name + ", ";
                                ingredientsModalItemNotChecked.dataset.amount = 0;
                                ingredientsModalItemNotChecked.dataset.name = ingredient;
                                ingredientsModalNotChecked.append(ingredientsModalItemNotChecked);                                
                            }
                        }
                    }
                    popUpContent.append(titleModal);
                    popUpContent.append(priceCaliriesModal);
                    priceCaliriesModal.append(priceModal);
                    priceModal.append(priceModalText);
                    priceModal.append(priceModalValue);
                    priceCaliriesModal.append(caloriesModal);
                    caloriesModal.append(caloriesModalText);
                    caloriesModal.append(caloriesModalValue);
                    popUpContent.append(compositionModal); 
                    popUpContent.append(ingredientsModal);
                    popUpContent.append(addIngredients);
                    popUpContent.append(ingredientsModalNotChecked);
        }
        //переворот карточки открытие попап
        let target;
        let allCardsTiles = document.querySelector('.products-list');
        let overlay = document.querySelector('.overlay');
        let popUp = document.querySelector('.pop-up');
        let popUpContent = document.querySelector('.pop-up-content');
        let body = document.querySelector('body');
        if(productsView === 'tile'){
            allCardsTiles.addEventListener( 'click', function(e) {
                if(e.target.closest('.product-card') && e.target.closest('.prouct-card__add-ingredients') === null){
                    e.target.closest('.product-card').classList.toggle('rotated');
                } else if(e.target.closest('.prouct-card__add-ingredients')){
                    createAllIngredients(allIngredientes);
                    target = e.target;
                    overlay.classList.add('visible');
                    body.classList.add('overflow');
                    renderPopup(target);
                }
            });
        }
        popUpContent.addEventListener('click', function(e){
            if(e.target.classList == 'product-modal__ingredient-item'){
                for(let i = 0; i< arr.length; i++){
                    if(target.parentElement.parentElement.querySelector('.product-card__name').innerText === arr[i].name){
                        if(e.target.dataset.amount == '1'){
                            allIngredientes[e.target.dataset.name] = arr[i].ingredients[e.target.dataset.name];
                            delete arr[i].ingredients[e.target.dataset.name];
                            
                        } else if( e.target.dataset.amount == '0'){
                            arr[i].ingredients[e.target.dataset.name] = allIngredientes[e.target.dataset.name];
                        }
                    }
                }
                popUpClear();  
                renderPopup(target);                             
            }
        }); 
        //закрытие попап
        let popupClose = document.querySelector('.pop-up__close');
        popupClose.addEventListener('click', function(){
            clearProducts();
            renderProducts(arr,productsView);
            overlay.classList.remove('visible');
            body.classList.remove('overflow');
            popUpClear();
        });

        //очистка попап
        function popUpClear(){
            popUpContent.innerText = '';
        }

    </script>
</body>
</html>